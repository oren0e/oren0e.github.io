<!DOCTYPE html>

<html lang="en-us">
    <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="format-detection" content="telephone=no"/>

    <title>Solving The Multi-Armed Bandit Problem with Thompson Sampling | Oren&#39;s ML Lounge</title>
    
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon.png">
    <link rel="manifest" href="/manifest.json">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#FF3DB4">
    <meta name="theme-color" content="#ffffff">

    
    
    
    <link rel="stylesheet" href="/css/main.min.15431d6c334f65809fe2bc329da3f2c81c6e3027ab1e25b56afb2bb85fa7fd64.css"/>

    
    
    

    
    
    <script type="text/javascript" async
  src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
  MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [['$','$'], ['\\(','\\)']],
    displayMath: [['$$','$$']],
    processEscapes: true,
    processEnvironments: true,
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
    TeX: { equationNumbers: { autoNumber: "AMS" },
         extensions: ["AMSmath.js", "AMSsymbols.js"] }
  }
  });
  MathJax.Hub.Queue(function() {
    
    
    
    var all = MathJax.Hub.getAllJax(), i;
    for(i = 0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });

  MathJax.Hub.Config({
  
  TeX: { equationNumbers: { autoNumber: "AMS" } }
  });
</script>
    </head>

    <body>
        
<nav>
  <header>
    <div class="site-title">
        <a href="/">Oren&#39;s ML Lounge</a>
    </div> 
    <link rel="shortcut icon" href="/favicon.ico"> 
</header>
  <div class="nav-menu">
  
    <a class="color-link nav-link" href="/about/">About</a>
  
    <a class="color-link nav-link" href="/tags/">Tags</a>
  
    <a class="color-link nav-link" href="/archives/">Archives</a>
  
  <a class="color-link nav-link" href="/index.xml" target="_blank" rel="noopener" type="application/rss+xml">RSS</a>
</div>
<footer class="footer">
	<div class="social-icons">
        

    

    
    <a class="social-icon" href="https://twitter.com/oepshtain" target="_blank" rel="noopener" title="Twitter">
        <svg width="28px" height="28px" viewBox="0 0 28 28" version="1.1" fill="#ABABAB" xmlns="https://www.w3.org/2000/svg" xmlns:xlink="https://www.w3.org/1999/xlink">
            <path d="M8.991284,24.971612 C19.180436,24.971612 24.752372,16.530224 24.752372,9.210524 C24.752372,8.970656 24.747512,8.731868 24.736496,8.494376 C25.818008,7.712564 26.758256,6.737 27.5,5.62622 C26.507372,6.067076 25.439252,6.364292 24.318752,6.498212 C25.462472,5.812628 26.340512,4.727444 26.754584,3.434036 C25.684088,4.068536 24.499004,4.53002 23.23724,4.778528 C22.226468,3.701876 20.786828,3.028388 19.193828,3.028388 C16.134404,3.028388 13.653536,5.509256 13.653536,8.567492 C13.653536,9.0023 13.702244,9.424904 13.797176,9.830552 C9.19346,9.599108 5.11106,7.39472 2.3792,4.04294 C1.903028,4.861364 1.629032,5.812628 1.629032,6.827072 C1.629032,8.74904 2.606972,10.445612 4.094024,11.438132 C3.185528,11.41016 2.331788,11.160464 1.585184,10.745096 C1.583888,10.768208 1.583888,10.791428 1.583888,10.815728 C1.583888,13.49888 3.493652,15.738584 6.028088,16.246508 C5.562932,16.373084 5.07326,16.44134 4.56782,16.44134 C4.210988,16.44134 3.863876,16.406024 3.526484,16.34144 C4.231724,18.542264 6.276596,20.143796 8.701412,20.18894 C6.805148,21.674696 4.416836,22.56008 1.821488,22.56008 C1.374476,22.56008 0.93362,22.534592 0.5,22.4834 C2.951708,24.054476 5.862524,24.971612 8.991284,24.971612"></path>
        </svg>
    </a>
    

    

    

    

    

    

    

    

    

    
    <a class="social-icon" href="https://www.linkedin.com/in/orenepshtain/" target="_blank" rel="noopener" title="LinkedIn">
        <svg width="28px" height="28px" viewBox="0 0 28 28" version="1.1" fill="#ABABAB" xmlns="https://www.w3.org/2000/svg" xmlns:xlink="https://www.w3.org/1999/xlink">
            <path d="M2,3.654102 C2,2.69908141 2.79442509,1.92397846 3.77383592,1.92397846 L24.2261641,1.92397846 C25.2058917,1.92397846 26,2.69908141 26,3.654102 L26,24.3462148 C26,25.3015521 25.2058917,26.0760215 24.2261641,26.0760215 L3.77383592,26.0760215 C2.79442509,26.0760215 2,25.3015521 2,24.3465315 L2,3.65378524 L2,3.654102 Z M9.27526132,22.1415901 L9.27526132,11.2356668 L5.65030092,11.2356668 L5.65030092,22.1415901 L9.27557808,22.1415901 L9.27526132,22.1415901 Z M7.46341463,9.74691162 C8.72727273,9.74691162 9.51409566,8.90940767 9.51409566,7.86284447 C9.49033893,6.79252455 8.72727273,5.97846056 7.48748812,5.97846056 C6.24675325,5.97846056 5.43649034,6.79252455 5.43649034,7.86284447 C5.43649034,8.90940767 6.22299652,9.74691162 7.4396579,9.74691162 L7.46309788,9.74691162 L7.46341463,9.74691162 Z M11.2815965,22.1415901 L14.9062401,22.1415901 L14.9062401,16.0519481 C14.9062401,15.7263225 14.9299968,15.4000634 15.0256573,15.1675641 C15.2876148,14.5159962 15.8840672,13.8416218 16.8856509,13.8416218 C18.1970225,13.8416218 18.7218879,14.8416218 18.7218879,16.3078872 L18.7218879,22.1415901 L22.3465315,22.1415901 L22.3465315,15.8885017 C22.3465315,12.5388027 20.5584416,10.9800443 18.1735825,10.9800443 C16.2182452,10.9800443 15.3595185,12.072854 14.8824834,12.8172315 L14.9065569,12.8172315 L14.9065569,11.2359835 L11.2819132,11.2359835 C11.3291099,12.2591067 11.2815965,22.1419069 11.2815965,22.1419069 L11.2815965,22.1415901 Z"></path>
        </svg>
    </a>
    

    

    

    

    

    

    

    
    
    
    <a class="social-icon" href="https://github.com/oren0e" target="_blank" rel="noopener" title="GitHub">
        <svg width="28px" height="28px" viewBox="0 0 28 28" version="1.1" fill="#ABABAB" xmlns="https://www.w3.org/2000/svg" xmlns:xlink="https://www.w3.org/1999/xlink">
            <path d="M13.9988029,1.32087331 C6.82105037,1.32087331 1,7.14112562 1,14.3212723 C1,20.0649109 4.72454649,24.9370678 9.89038951,26.6560892 C10.5408085,26.7757983 10.7778323,26.374374 10.7778323,26.0296121 C10.7778323,25.7215609 10.7666595,24.9035493 10.760275,23.8189856 C7.14426471,24.6042767 6.38131925,22.0760223 6.38131925,22.0760223 C5.78995672,20.5740732 4.93762853,20.1742451 4.93762853,20.1742451 C3.75729765,19.3682044 5.02701126,19.3841656 5.02701126,19.3841656 C6.33183953,19.4759425 7.01817121,20.7241085 7.01817121,20.7241085 C8.17775254,22.7104801 10.0611744,22.1366749 10.8017741,21.8038838 C10.919887,20.9643246 11.2558703,20.3913175 11.6269683,20.066507 C8.74038491,19.7385043 5.70536235,18.6228163 5.70536235,13.6413251 C5.70536235,12.2223743 6.21213051,11.0611968 7.04370914,10.1530044 C6.90963504,9.82420367 6.46351945,8.50181809 7.17139875,6.71256734 C7.17139875,6.71256734 8.26234691,6.36301702 10.7459099,8.04532771 C11.78259,7.75642995 12.8950858,7.61277914 14.000399,7.60719272 C15.1049142,7.61277914 16.2166119,7.75642995 17.2548881,8.04532771 C19.736855,6.36301702 20.8262071,6.71256734 20.8262071,6.71256734 C21.5356825,8.50181809 21.0895669,9.82420367 20.9562909,10.1530044 C21.7894656,11.0611968 22.2922435,12.2223743 22.2922435,13.6413251 C22.2922435,18.6355852 19.2524325,19.734514 16.3570705,20.0561322 C16.8231376,20.4575564 17.2389269,21.2508282 17.2389269,22.4638795 C17.2389269,24.2012564 17.2229657,25.603448 17.2229657,26.0296121 C17.2229657,26.3775663 17.4575954,26.7821827 18.116793,26.6552912 C23.2786458,24.9322794 27,20.0633148 27,14.3212723 C27,7.14112562 21.1789496,1.32087331 13.9988029,1.32087331"></path>
        </svg>
    </a>
    

    
    
    

    

    

    

    

    

</div>





	<script src="/js/main.min.fa5c2b23e07b5d9bfad267a52b4b24fdb053e6fb7524993383594926a3ac270c.js" integrity="sha256-+lwrI+B7XZv60melK0sk/bBT5vt1JJkzg1lJJqOsJww=" crossorigin="anonymous"></script>
</footer>
</nav>

        <div id="content" class="content-container">
        

<h1 class="post-title">Solving The Multi-Armed Bandit Problem with Thompson Sampling</h1>
    
    <time>April 27, 2020</time>
    
    <div>
        <p>
        <p>Imagine that you are a data scientist working for a company that offers some sort of service by subscription. Let&rsquo;s be more specific - your company offers an online LaTeX editor that everyone can
use with some limitations: They cannot write long documents and they can&rsquo;t use math notation, unless, they choose to sign up to your website and for a small fee of 10$ a month they get the access to all of your
latex website features.</p>
<p>One day, The VP of design comes to you and says that his team have made some improvement to the toolbar of the editing window and they think that this will help the users to be more effective, thus
increasing the sign-ups for you website. You are more skeptic, so you conduct an A/B test where you offer the regular-website version to a randomly selected group of your users, and the new-toolbar version to a
second randomly selected group of users. You observe the sign-up rate for each group and conduct a statistical test which confirms that indeed, the new version &ldquo;causes&rdquo; more users to signup. You have increased
your company&rsquo;s revenues, and you and the VP of design give high-five to each other.</p>
<p>After a month, the VP of design knocks on your door once more. This time, he says that his team had produced several toolbar designs and they were not able to decide which version is better. He&rsquo;s sure that
you will be able to A/B test them all and find the best version that increases signups the most. Again, you are more skeptic.</p>
<h2 id="why-ab-testing-with-multiple-variants-is-a-bad-idea">Why A/B Testing With Multiple Variants is a Bad Idea</h2>
<p>If you follow along the lines of a standard A/B test procedure when you have multiple variations that you want to test, you will probably start by comparing each variant against the control group, i.e., the group that gets to see the original non-altered website. There are couple of problems with that:</p>
<ol>
<li>With many comparisons, the probability of discovering at least one false-positive result, i.e., rejecting the null hypothesis when it is actually true, increases. The higher the number of variants to compare, the higher the chance of finding a false &ldquo;winner&rdquo;.</li>
<li>It is not enough to compare each variant against the control to find the best variation. You will also need to compare each variant against each of the other variants. In this case, the number of tests increase and the chances of finding a false winner increase even more.</li>
<li>Another reason why this is a bad thing to do is that you&rsquo;ll need more data to conclude which is the winning variation, this in turn will lead you to run the tests longer. As the old saying goes: time is money. While you are conducting your tests you are loosing potential customers - these are the ones that get assigned to see the worse variants.</li>
</ol>
<h2 id="the-multi-armed-bandit-problem">The Multi-Armed Bandit Problem</h2>
<p>The problem our data scientist from the story above faces is a general problem of <em>exploration vs exploitation</em>, i.e., choosing the right ratio between exploring the different options and investigating each option in depth. These kind of problems are known as the Multi-Armed Bandit (MAB) problems. The origin of the name comes from the casino world, a place where a lot of statistical terms were firstly coined. The &ldquo;bandit&rdquo; is the slot machine which was called like that because it basically stole money from people. Each machine has an &ldquo;arm&rdquo; that the player pulls in order to start to play.</p>
<p>The MAB problem describes a person who comes into a casino and has limited time so he can play only $N$ games. He is facing a row of $M$ machines which all have different mechanisms so the probability of winning each one is different. The question is what should this person do? How many machines should he play and for how many rounds each in order to maximize his winnings?</p>
<h2 id="a-bayesian-solution">A Bayesian Solution</h2>
<p>Following up on point 3 above - what if there was a procedure which could choose the best variant <em>at real time</em>? Then we could offer the best variant to the users without loosing any potential signups. Well, it turns out that there is such a procedure and its called <em>Thompson Sampling</em>. But before I&rsquo;ll describe this algorithm I want to review the core concepts of Bayesian analysis since Thompson Sampling utilizes these concepts.</p>
<h3 id="bayesian-analysis">Bayesian Analysis</h3>
<p>In bayesian methods we assume something about the world and then use data to update our assumptions. So if there is a stream of data that we want to estimate its generating mechanism, i.e., the &ldquo;function&rdquo; that created this stream of data, we need to make an initial assumption about this &ldquo;function&rdquo; first, this is called our <strong>prior</strong> beliefs. Once we have our prior stated we proceed to observe the data and then update our priors accordingly. In the frequentist world view - this generating &ldquo;function&rdquo; has the same parameters each and every time it runs, in the bayesian world view the function&rsquo;s parameters are random variables, i.e., they have a probability distribution. Bayes rule states that we can infer the distribution of the parameters $\theta$ of this &ldquo;function&rdquo; with the help of the data we observe $D$.
$$P(\theta|D) = \frac{P(D|\theta)P(\theta)}{P(D)}$$</p>
<p>where $P(\theta|D)$ is called the <strong>posterior</strong>, i.e., our updated-by-data beliefs, $P(D|\theta)$ is called the <strong>likelihood</strong> and it represents the likelihood of the data given our beliefs. $P(\theta)$ is the <strong>prior</strong>. Finally, $P(D)$ represents the probability of the data over all possible beliefs, and it is usually thought of as a normalizing constant.</p>
<p>The great thing about bayesian methods is the fact that it really resembles human thinking. We all have our beliefs about something, and even when we don&rsquo;t, we tend to make them on the spot (for instance if I were to hold my two hands as fists in front of you and say that inside one of them there is a coin, without knowing anything about me, you&rsquo;ll probably say to yourself that there is a 50-50 chance for the coin to be inside each one of my fists). The weakest spot of bayesian methods is the choice of the prior. Some priors may allow us to compute the bayseian update in a closed-form formula, others will require the use of computational methods.</p>
<h3 id="thompson-sampling">Thompson Sampling</h3>
<p>The procedure of Thompson sampling is a simple iterative process:</p>
<ol>
<li>Assuming we have $M$ variants with unknown-to-us conversion rates $(\theta_1, \ldots, \theta_M)$, we randomly assign a value from the prior distribution for each one of these parameters. Think of these as the initial conversion rates.</li>
<li>We pick the variant with the highest value.</li>
<li>We offer this variant to the users and observe how many signed up and how many didn&rsquo;t.</li>
<li>We then take this new information and update our prior accordingly.</li>
</ol>
<p>We repeat the above process until some stopping criterion is activated. For example it could be a fixed number of iterations that we had decided upon beforehand, or that a certain variant is &ldquo;winning&rdquo; for $x$ iterations in a row.</p>
<h4 id="choice-of-prior">Choice of Prior</h4>
<p>The main decision left for us to decide is the distribution we are going to use in order to mathematically represent our prior beliefs. Now since our outcome is a simple binary outcome (sign-up/not sign-up) a very common prior to choose which has several desired properties is the <em>Beta distribution</em>.</p>
<p>The Beta distribution is governed by two parameters $a$ and $b$, and depending on its values, the distribution can take on many shapes. The main reasons we want to use this distribution as our prior are:</p>
<ol>
<li>The Beta distribution is known to be a <em>conjugate prior</em> to the Bernoulli likelihood (the binary outcome we have). This means that when we calculate the posterior by multiplying the likelihood by the prior - we get a posterior which is Beta-distributed as well. This allows us to make the bayesian update more easily (mathematical demonstration coming up).</li>
<li>The mean of the Beta distribution is equal to the proportion of positive cases (in a positive/negative binary outcome) which in our case is exactly what we&rsquo;re after, i.e., the conversion rate (the proportion of sign-ups).</li>
<li>Another feature of the Beta distribution is that if $a=1$ and $b=1$ the Beta distribution becomes the Uniform distribution which essentially assigns an equal probability to each item. This is desirable because we want to give each variant an equal chance of being the winning variant before we get any information from the users&rsquo; choices.</li>
</ol>
<h5 id="mathematical-proof-for-beta-distribution-being-conjugate-prior-to-bernoulli-outcome">Mathematical Proof for Beta Distribution Being Conjugate Prior to Bernoulli Outcome</h5>
<p>You can skip to the conclusion of this part if you are not interested in the mathematical details, it will not harm your understanding of the concepts being discussed here.</p>
<p>Lets say I want to check if a coin is fair. I observed $z$ heads in $N$ flips (this is the data).
My prior is Beta distributed:<br>
$$\begin{aligned}
P(\theta) = \frac{\theta^{(a-1)}(1-\theta)^{(b-1)}}{B(a,b)} \quad, B(a,b) = \int_0^1 \theta^{a-1}(1-\theta)^{b-1}d\theta
\end{aligned}$$
And my Bernoulli likelihood of the outcome I just observed is $\theta^z(1-\theta)^{(N-z)}$. $\theta$ is the proportion of heads.<br>
Then by Bayes&rsquo; rule:<br>
$$\begin{aligned}
P(\theta|N, z) &amp;= \frac{P(N, z|\theta)P(\theta)}{P(N, z)} = \frac{\theta^z(1-\theta)^{(N-z)}\theta^{(a-1)}(1-\theta)^{(b-1)}}{B(a,b)P(N, z)} \\<br>
&amp;= \frac{\theta^{((a+z)-1)}(1-\theta)^{((b+N-z)-1)}}{B(a+z,b+N-z)} \sim \textrm{Beta}(a+z,b+N-z)
\end{aligned}$$</p>
<p>The conclusion is that we see that the update process is as simple as adding the number of heads we observed to $a$ and the number of tails we observed to $b$ - that&rsquo;s it. This is what we will do in our procedure as well - e.g., if we observe 10 sign-ups we will add this number to our prior (Beta) distribution&rsquo;s $a$ parameter and the same for non sign-ups for $b$.</p>
<h3 id="python-simulation">Python Simulation</h3>
<p>Let&rsquo;s code these concepts to see if our intuition is correct. All the code can be found in my <a href="https://github.com/oren0e/mab-thompson">Github repo</a>.</p>
<p><strong>Note about reading the code</strong>: If you&rsquo;ll try to read the code in the order it is presented here you&rsquo;ll find that there are some parts that are actually being used before they have been defined so it is best to go back and forth across the different sections (or look at the github repo linked above). I am presenting it in this order for ease of explanation.</p>
<p>First we define an <code>Environment</code> class which facilitates running the simulation and saving states of important variables.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#204a87;font-weight:bold">from</span> <span style="color:#000">__future__</span> <span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">annotations</span>

<span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">numpy</span> <span style="color:#204a87;font-weight:bold">as</span> <span style="color:#000">np</span>

<span style="color:#204a87;font-weight:bold">from</span> <span style="color:#000">typing</span> <span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">Optional</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">Tuple</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">List</span>


<span style="color:#204a87;font-weight:bold">class</span> <span style="color:#000">Environment</span><span style="color:#000;font-weight:bold">:</span>
    <span style="color:#204a87;font-weight:bold">def</span> <span style="color:#000">__init__</span><span style="color:#000;font-weight:bold">(</span><span style="color:#3465a4">self</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">payouts</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000">np</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">ndarray</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">variants</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000">np</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">ndarray</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">-&gt;</span> <span style="color:#3465a4">None</span><span style="color:#000;font-weight:bold">:</span>
        <span style="color:#3465a4">self</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">payouts</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">payouts</span>
        <span style="color:#3465a4">self</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">variants</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">variants</span>
        <span style="color:#3465a4">self</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">variants_rewards</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000">np</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">ndarray</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">np</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">zeros</span><span style="color:#000;font-weight:bold">(</span><span style="color:#3465a4">self</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">variants</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">shape</span><span style="color:#000;font-weight:bold">)</span>
        <span style="color:#3465a4">self</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">total_reward</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#204a87">int</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">0</span>
        <span style="color:#3465a4">self</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">a_b_beta_prams</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000">List</span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">List</span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">Tuple</span><span style="color:#000;font-weight:bold">[</span><span style="color:#204a87">float</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87">float</span><span style="color:#000;font-weight:bold">]]]</span> <span style="color:#ce5c00;font-weight:bold">=</span> 
        <span style="color:#000;font-weight:bold">[[(</span><span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#204a87;font-weight:bold">for</span> <span style="color:#000">_</span> <span style="color:#204a87;font-weight:bold">in</span> <span style="color:#204a87">range</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87">len</span><span style="color:#000;font-weight:bold">(</span><span style="color:#3465a4">self</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">variants</span><span style="color:#000;font-weight:bold">))]]</span>

    <span style="color:#204a87;font-weight:bold">def</span> <span style="color:#000">run</span><span style="color:#000;font-weight:bold">(</span><span style="color:#3465a4">self</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">agent</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000">ThompsonSampler</span><span style="color:#000;font-weight:bold">,</span>
            <span style="color:#000">n_trials</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#204a87">int</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">1000</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">-&gt;</span> <span style="color:#000">Tuple</span><span style="color:#000;font-weight:bold">[</span><span style="color:#204a87">int</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">np</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">ndarray</span><span style="color:#000;font-weight:bold">]:</span>
        <span style="color:#4e9a06">&#34;&#34;&#34;
</span><span style="color:#4e9a06">        Runs the simulation and return total reward from using
</span><span style="color:#4e9a06">        the sampler chosen.
</span><span style="color:#4e9a06">        &#34;&#34;&#34;</span>

        <span style="color:#204a87;font-weight:bold">for</span> <span style="color:#000">i</span> <span style="color:#204a87;font-weight:bold">in</span> <span style="color:#204a87">range</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">n_trials</span><span style="color:#000;font-weight:bold">):</span>
            <span style="color:#000">best_variant</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">agent</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">choose_variant</span><span style="color:#000;font-weight:bold">()</span>
            <span style="color:#8f5902;font-style:italic"># mimick real behaviour</span>
            <span style="color:#000">agent</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">reward</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">np</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">random</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">binomial</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">n</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">p</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#3465a4">self</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">payouts</span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">best_variant</span><span style="color:#000;font-weight:bold">])</span>
            <span style="color:#000">agent</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">update</span><span style="color:#000;font-weight:bold">()</span>

            <span style="color:#3465a4">self</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">a_b_beta_prams</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">append</span><span style="color:#000;font-weight:bold">(</span>
            <span style="color:#000;font-weight:bold">[(</span><span style="color:#000">a_i</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">b_i</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#204a87;font-weight:bold">for</span> <span style="color:#000">a_i</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">b_i</span> <span style="color:#204a87;font-weight:bold">in</span> <span style="color:#204a87">zip</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">agent</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">a</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">agent</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">b</span><span style="color:#000;font-weight:bold">)])</span>
            <span style="color:#3465a4">self</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">total_reward</span> <span style="color:#ce5c00;font-weight:bold">+=</span> <span style="color:#000">agent</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">reward</span>
            <span style="color:#3465a4">self</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">variants_rewards</span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">best_variant</span><span style="color:#000;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">+=</span> <span style="color:#000">agent</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">reward</span>

        <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#3465a4">self</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">total_reward</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#3465a4">self</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">variants_rewards</span>
</code></pre></div><p>This class can facilitate different samplers, not just the Thompson sampler, although it is the only one I have implemented here.<br>
The <code>payouts</code> in the constructor is a Numpy array of the true conversion rates of the different variants (for the sake of simulation) and the <code>variants</code> variable is an array of variant indices.</p>
<p>Notice that in the <code>run()</code> method we model the decision of the customer of whether to sign-up or not by a Bernoulli trial with the probability of success being the underlying probability of the current best variant (updated from round to round). This does not mean that this variant will get more sign-ups necessarily. In expectation, it has a higher chance to get more sign-ups, but it might change as the simulation continues.</p>
<p>Notice also that like we said above, we are starting with a $(a,b) = (1,1)$ parameters for the Beta distribution to take a Uniform prior at the beginning, reflecting our lack of knowledge about which variant is better.</p>
<p>Next, we define a general <code>Sampler</code> class in order to be able to come back later and maybe add some more samplers&rsquo; implementations.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#204a87;font-weight:bold">class</span> <span style="color:#000">Sampler</span><span style="color:#000;font-weight:bold">:</span>
    <span style="color:#204a87;font-weight:bold">def</span> <span style="color:#000">__init__</span><span style="color:#000;font-weight:bold">(</span><span style="color:#3465a4">self</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">env</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000">Environment</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">-&gt;</span> <span style="color:#3465a4">None</span><span style="color:#000;font-weight:bold">:</span>
        <span style="color:#3465a4">self</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">env</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">env</span>
        <span style="color:#3465a4">self</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">theta</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000">Optional</span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">np</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">ndarray</span><span style="color:#000;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#3465a4">None</span>
        <span style="color:#3465a4">self</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">best_variant</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000">Optional</span><span style="color:#000;font-weight:bold">[</span><span style="color:#204a87">int</span><span style="color:#000;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#3465a4">None</span>
        <span style="color:#3465a4">self</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">reward</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#204a87">int</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">0</span>

    <span style="color:#204a87;font-weight:bold">def</span> <span style="color:#000">choose_variant</span><span style="color:#000;font-weight:bold">(</span><span style="color:#3465a4">self</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">-&gt;</span> <span style="color:#000">Optional</span><span style="color:#000;font-weight:bold">[</span><span style="color:#204a87">int</span><span style="color:#000;font-weight:bold">]:</span>
        <span style="color:#204a87;font-weight:bold">raise</span> <span style="color:#c00;font-weight:bold">NotImplementedError</span>

    <span style="color:#204a87;font-weight:bold">def</span> <span style="color:#000">update</span><span style="color:#000;font-weight:bold">(</span><span style="color:#3465a4">self</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">-&gt;</span> <span style="color:#3465a4">None</span><span style="color:#000;font-weight:bold">:</span>
        <span style="color:#204a87;font-weight:bold">raise</span> <span style="color:#c00;font-weight:bold">NotImplementedError</span>
</code></pre></div><p>We want 3 things from a sampler - that it is connected to some environment, have a procedure to choose the best variant, and an update procedure.</p>
<p>The <code>ThompsonSampler</code> class is one such sampler.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#204a87;font-weight:bold">class</span> <span style="color:#000">ThompsonSampler</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">Sampler</span><span style="color:#000;font-weight:bold">):</span>
    <span style="color:#204a87;font-weight:bold">def</span> <span style="color:#000">__init__</span><span style="color:#000;font-weight:bold">(</span><span style="color:#3465a4">self</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">env</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000">Environment</span><span style="color:#000;font-weight:bold">):</span>
        <span style="color:#204a87">super</span><span style="color:#000;font-weight:bold">()</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">__init__</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">env</span><span style="color:#000;font-weight:bold">)</span>
        <span style="color:#3465a4">self</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">a</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">np</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">ones</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87">len</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">env</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">variants</span><span style="color:#000;font-weight:bold">))</span>  <span style="color:#8f5902;font-style:italic"># prior of beta(1,1)</span>
        <span style="color:#3465a4">self</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">b</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">np</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">ones</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87">len</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">env</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">variants</span><span style="color:#000;font-weight:bold">))</span>  <span style="color:#8f5902;font-style:italic"># prior of beta(1,1)</span>

    <span style="color:#204a87;font-weight:bold">def</span> <span style="color:#000">choose_variant</span><span style="color:#000;font-weight:bold">(</span><span style="color:#3465a4">self</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">-&gt;</span> <span style="color:#000">Optional</span><span style="color:#000;font-weight:bold">[</span><span style="color:#204a87">int</span><span style="color:#000;font-weight:bold">]:</span>
        <span style="color:#3465a4">self</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">theta</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">np</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">random</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">beta</span><span style="color:#000;font-weight:bold">(</span><span style="color:#3465a4">self</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">a</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#3465a4">self</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">b</span><span style="color:#000;font-weight:bold">)</span>
        <span style="color:#3465a4">self</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">best_variant</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#3465a4">self</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">env</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">variants</span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">np</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">argmax</span><span style="color:#000;font-weight:bold">(</span><span style="color:#3465a4">self</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">theta</span><span style="color:#000;font-weight:bold">)]</span>

        <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#3465a4">self</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">best_variant</span>

    <span style="color:#204a87;font-weight:bold">def</span> <span style="color:#000">update</span><span style="color:#000;font-weight:bold">(</span><span style="color:#3465a4">self</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">-&gt;</span> <span style="color:#3465a4">None</span><span style="color:#000;font-weight:bold">:</span>
        <span style="color:#3465a4">self</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">a</span><span style="color:#000;font-weight:bold">[</span><span style="color:#3465a4">self</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">best_variant</span><span style="color:#000;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">+=</span> <span style="color:#3465a4">self</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">reward</span>
        <span style="color:#3465a4">self</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">b</span><span style="color:#000;font-weight:bold">[</span><span style="color:#3465a4">self</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">best_variant</span><span style="color:#000;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">+=</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#0000cf;font-weight:bold">1</span> <span style="color:#ce5c00;font-weight:bold">-</span> <span style="color:#3465a4">self</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">reward</span><span style="color:#000;font-weight:bold">)</span>
</code></pre></div><p>It basically implements the update procedure we explained above (under the assumption that a Beta prior is being used).</p>
<p>With the definitions done, we turn to performing the simulation:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">numpy</span> <span style="color:#204a87;font-weight:bold">as</span> <span style="color:#000">np</span>

<span style="color:#204a87;font-weight:bold">from</span> <span style="color:#000">core</span> <span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">Environment</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">ThompsonSampler</span>

<span style="color:#204a87;font-weight:bold">from</span> <span style="color:#000">plot_funcs</span> <span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">plot_variants</span>

<span style="color:#8f5902;font-style:italic"># setup the &#34;true&#34; unknown parameters</span>
<span style="color:#000">pay</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">np</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">array</span><span style="color:#000;font-weight:bold">([</span><span style="color:#0000cf;font-weight:bold">0.55</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">0.04</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">0.80</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">0.09</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">0.22</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">0.012</span><span style="color:#000;font-weight:bold">])</span>
<span style="color:#000">variants</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">np</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">arange</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87">len</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">pay</span><span style="color:#000;font-weight:bold">))</span>

<span style="color:#8f5902;font-style:italic"># perform the simulation</span>
<span style="color:#000">np</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">random</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">seed</span><span style="color:#000;font-weight:bold">(</span><span style="color:#0000cf;font-weight:bold">1425</span><span style="color:#000;font-weight:bold">)</span>
<span style="color:#000">env0</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">Environment</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">payouts</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000">pay</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">variants</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000">variants</span><span style="color:#000;font-weight:bold">)</span>
<span style="color:#000">samp</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">ThompsonSampler</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">env0</span><span style="color:#000;font-weight:bold">)</span>
<span style="color:#000">env0</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">run</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">agent</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000">samp</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">n_trials</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#0000cf;font-weight:bold">1000</span><span style="color:#000;font-weight:bold">)</span>
</code></pre></div><div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#000;font-weight:bold">(</span><span style="color:#0000cf;font-weight:bold">780</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">array</span><span style="color:#000;font-weight:bold">([</span>  <span style="color:#0000cf;font-weight:bold">2.</span><span style="color:#000;font-weight:bold">,</span>   <span style="color:#0000cf;font-weight:bold">0.</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">774.</span><span style="color:#000;font-weight:bold">,</span>   <span style="color:#0000cf;font-weight:bold">0.</span><span style="color:#000;font-weight:bold">,</span>   <span style="color:#0000cf;font-weight:bold">4.</span><span style="color:#000;font-weight:bold">,</span>   <span style="color:#0000cf;font-weight:bold">0.</span><span style="color:#000;font-weight:bold">]))</span>
</code></pre></div><p>At the end of the simulation we get an output of the total reward, i.e., the total number of sign-ups, and the distribution of sign-ups across the different variants.<br>
We can see that variant 2 (index 2 in the <code>pay</code> array, starting from 0) has the highest underlying conversion rate, but we also have variants 0 and 4 with somewhat high conversion rates as well. We can see from the output that almost all of the sign-ups in our simulation were done under variant 2 and very few under variants 0 and 4, so the results are consistent with the true rates.</p>
<p>Let&rsquo;s plot the distributions after varying number of iterations:</p>
<p><img src="/iter10.png" alt="">
<img src="/iter200.png" alt="">
<img src="/iter500.png" alt="">
<img src="/iter900.png" alt=""></p>
<p>We can see that after 10 iterations variants 2 and 4 have large probabilities to sign-up, but as the iterations continue we see that the best variant, variant 2, is converging to its underlying probability with very small uncertainty (this is because we are in a simulation). Notice also that the poor variants have all fatter left tails indicating its low underlying conversion rates.</p>
<h2 id="conclusion">Conclusion</h2>
<p>In this post we saw how can we utilize a Bayesian method, the Thompson Sampling procedure, in settings where we need to make a decision about which version of our product to go with among <strong>several</strong> different possible versions.<br>
We saw that performing a regular A/B test has its drawbacks and in particular that it does not allow us to solve the exploration vs. exploitation problem in a very good way but using the Thompson Sampling procedure does.<br>
Finally, we&rsquo;ve constructed a simple simulation to illustrate these ideas.</p>
<p>Thanks for reading!</p>

        </p>
    </div>
    

    

    <div class="page-footer">
        
        <hr class="footer-divider">
        
            <a class="tag" href="/tags/reinforcement-learning">#reinforcement learning</a>
        
            <a class="tag" href="/tags/bayes">#bayes</a>
        
            <a class="tag" href="/tags/ab-testing">#AB testing</a>
        
      
    </div>


        

<link rel="stylesheet" type="text/css" href="/css/katex.min.css" crossorigin="anonymous">
<script type="text/javascript" src="/js/katex.min.js" crossorigin="anonymous"></script>
<script type="text/javascript" src="/js/auto-render.min.js"onload="renderMathInElement(document.body);" crossorigin="anonymous"></script>

        </div>
        <footer class="footer-mobile">
	<div class="social-icons">
        

    

    
    <a class="social-icon" href="https://twitter.com/oepshtain" target="_blank" rel="noopener" title="Twitter">
        <svg width="28px" height="28px" viewBox="0 0 28 28" version="1.1" fill="#ABABAB" xmlns="https://www.w3.org/2000/svg" xmlns:xlink="https://www.w3.org/1999/xlink">
            <path d="M8.991284,24.971612 C19.180436,24.971612 24.752372,16.530224 24.752372,9.210524 C24.752372,8.970656 24.747512,8.731868 24.736496,8.494376 C25.818008,7.712564 26.758256,6.737 27.5,5.62622 C26.507372,6.067076 25.439252,6.364292 24.318752,6.498212 C25.462472,5.812628 26.340512,4.727444 26.754584,3.434036 C25.684088,4.068536 24.499004,4.53002 23.23724,4.778528 C22.226468,3.701876 20.786828,3.028388 19.193828,3.028388 C16.134404,3.028388 13.653536,5.509256 13.653536,8.567492 C13.653536,9.0023 13.702244,9.424904 13.797176,9.830552 C9.19346,9.599108 5.11106,7.39472 2.3792,4.04294 C1.903028,4.861364 1.629032,5.812628 1.629032,6.827072 C1.629032,8.74904 2.606972,10.445612 4.094024,11.438132 C3.185528,11.41016 2.331788,11.160464 1.585184,10.745096 C1.583888,10.768208 1.583888,10.791428 1.583888,10.815728 C1.583888,13.49888 3.493652,15.738584 6.028088,16.246508 C5.562932,16.373084 5.07326,16.44134 4.56782,16.44134 C4.210988,16.44134 3.863876,16.406024 3.526484,16.34144 C4.231724,18.542264 6.276596,20.143796 8.701412,20.18894 C6.805148,21.674696 4.416836,22.56008 1.821488,22.56008 C1.374476,22.56008 0.93362,22.534592 0.5,22.4834 C2.951708,24.054476 5.862524,24.971612 8.991284,24.971612"></path>
        </svg>
    </a>
    

    

    

    

    

    

    

    

    

    
    <a class="social-icon" href="https://www.linkedin.com/in/orenepshtain/" target="_blank" rel="noopener" title="LinkedIn">
        <svg width="28px" height="28px" viewBox="0 0 28 28" version="1.1" fill="#ABABAB" xmlns="https://www.w3.org/2000/svg" xmlns:xlink="https://www.w3.org/1999/xlink">
            <path d="M2,3.654102 C2,2.69908141 2.79442509,1.92397846 3.77383592,1.92397846 L24.2261641,1.92397846 C25.2058917,1.92397846 26,2.69908141 26,3.654102 L26,24.3462148 C26,25.3015521 25.2058917,26.0760215 24.2261641,26.0760215 L3.77383592,26.0760215 C2.79442509,26.0760215 2,25.3015521 2,24.3465315 L2,3.65378524 L2,3.654102 Z M9.27526132,22.1415901 L9.27526132,11.2356668 L5.65030092,11.2356668 L5.65030092,22.1415901 L9.27557808,22.1415901 L9.27526132,22.1415901 Z M7.46341463,9.74691162 C8.72727273,9.74691162 9.51409566,8.90940767 9.51409566,7.86284447 C9.49033893,6.79252455 8.72727273,5.97846056 7.48748812,5.97846056 C6.24675325,5.97846056 5.43649034,6.79252455 5.43649034,7.86284447 C5.43649034,8.90940767 6.22299652,9.74691162 7.4396579,9.74691162 L7.46309788,9.74691162 L7.46341463,9.74691162 Z M11.2815965,22.1415901 L14.9062401,22.1415901 L14.9062401,16.0519481 C14.9062401,15.7263225 14.9299968,15.4000634 15.0256573,15.1675641 C15.2876148,14.5159962 15.8840672,13.8416218 16.8856509,13.8416218 C18.1970225,13.8416218 18.7218879,14.8416218 18.7218879,16.3078872 L18.7218879,22.1415901 L22.3465315,22.1415901 L22.3465315,15.8885017 C22.3465315,12.5388027 20.5584416,10.9800443 18.1735825,10.9800443 C16.2182452,10.9800443 15.3595185,12.072854 14.8824834,12.8172315 L14.9065569,12.8172315 L14.9065569,11.2359835 L11.2819132,11.2359835 C11.3291099,12.2591067 11.2815965,22.1419069 11.2815965,22.1419069 L11.2815965,22.1415901 Z"></path>
        </svg>
    </a>
    

    

    

    

    

    

    

    
    
    
    <a class="social-icon" href="https://github.com/oren0e" target="_blank" rel="noopener" title="GitHub">
        <svg width="28px" height="28px" viewBox="0 0 28 28" version="1.1" fill="#ABABAB" xmlns="https://www.w3.org/2000/svg" xmlns:xlink="https://www.w3.org/1999/xlink">
            <path d="M13.9988029,1.32087331 C6.82105037,1.32087331 1,7.14112562 1,14.3212723 C1,20.0649109 4.72454649,24.9370678 9.89038951,26.6560892 C10.5408085,26.7757983 10.7778323,26.374374 10.7778323,26.0296121 C10.7778323,25.7215609 10.7666595,24.9035493 10.760275,23.8189856 C7.14426471,24.6042767 6.38131925,22.0760223 6.38131925,22.0760223 C5.78995672,20.5740732 4.93762853,20.1742451 4.93762853,20.1742451 C3.75729765,19.3682044 5.02701126,19.3841656 5.02701126,19.3841656 C6.33183953,19.4759425 7.01817121,20.7241085 7.01817121,20.7241085 C8.17775254,22.7104801 10.0611744,22.1366749 10.8017741,21.8038838 C10.919887,20.9643246 11.2558703,20.3913175 11.6269683,20.066507 C8.74038491,19.7385043 5.70536235,18.6228163 5.70536235,13.6413251 C5.70536235,12.2223743 6.21213051,11.0611968 7.04370914,10.1530044 C6.90963504,9.82420367 6.46351945,8.50181809 7.17139875,6.71256734 C7.17139875,6.71256734 8.26234691,6.36301702 10.7459099,8.04532771 C11.78259,7.75642995 12.8950858,7.61277914 14.000399,7.60719272 C15.1049142,7.61277914 16.2166119,7.75642995 17.2548881,8.04532771 C19.736855,6.36301702 20.8262071,6.71256734 20.8262071,6.71256734 C21.5356825,8.50181809 21.0895669,9.82420367 20.9562909,10.1530044 C21.7894656,11.0611968 22.2922435,12.2223743 22.2922435,13.6413251 C22.2922435,18.6355852 19.2524325,19.734514 16.3570705,20.0561322 C16.8231376,20.4575564 17.2389269,21.2508282 17.2389269,22.4638795 C17.2389269,24.2012564 17.2229657,25.603448 17.2229657,26.0296121 C17.2229657,26.3775663 17.4575954,26.7821827 18.116793,26.6552912 C23.2786458,24.9322794 27,20.0633148 27,14.3212723 C27,7.14112562 21.1789496,1.32087331 13.9988029,1.32087331"></path>
        </svg>
    </a>
    

    
    
    

    

    

    

    

    

</div>




	<div class="footer-mobile-links">
		<p><a href="https://github.com/kimcc/hugo-theme-noteworthy" target="_blank" rel="noopener">Noteworthy theme</a></p>
		<span class="divider-bar">|</span>
		<p><a href="https://gohugo.io" target="_blank" rel="noopener">Built with Hugo</a></p>
	</div>

	<script src="/js/main.min.fa5c2b23e07b5d9bfad267a52b4b24fdb053e6fb7524993383594926a3ac270c.js" integrity="sha256-+lwrI+B7XZv60melK0sk/bBT5vt1JJkzg1lJJqOsJww=" crossorigin="anonymous"></script>
</footer>
    </body>
</html>